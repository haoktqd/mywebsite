<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Charts</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
    <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>

    <style>

        #loadingSpinner,#vtgLoadingSpinner {
            position: fixed; /* Đảm bảo spinner cố định ở giữa màn hình */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 20px;
            font-weight: bold;
            color: #ae1e6a;
            z-index: 9999; 
        }


        /* Spinner styling */
        .spinner {
            border: 8px solid rgba(0, 0, 0, 0.1); /* Màu viền mờ */
            border-top: 8px solid #ae1e6a; /* Viền trên sẽ có màu nổi bật */
            border-radius: 50%;
            width: 60px; /* Kích thước của biểu tượng */
            height: 60px; 
            animation: spin 1s linear infinite; /* Tạo hiệu ứng xoay */
            margin: auto;
        }

        /* Keyframes cho hiệu ứng xoay tròn */
        @keyframes spin {
            0% {
                transform: rotate(0deg); /* Bắt đầu từ 0 độ */
            }
            100% {
                transform: rotate(360deg); /* Xoay hoàn toàn 360 độ */
            }
        }

        
        #ChartContainer, #vtgContent, #vtcContent, #stlContent, #vtlContent,#mynContent,#vbdContent,#movContent,#vtzContent, #ncmContent {
            display: flex;
            justify-content: center; 
            align-items: center;  
            display: flex; 
            flex-direction: column;
        }

        canvas {
            display: block;
            max-width: 95vw; 
            max-height: 95vh;
            align-items: center;
            align-content: center;
            
        }

        /* Style cho menu và tiêu đề */
        .header {
            display: static;
            align-items: center;
            justify-content: left;
            text-align: left;
        }


        button {
            padding: 12px 24px; /* Tăng khoảng cách bên trong nút */
            font-size: 16px; /* Kích thước chữ */
            border: none; /* Xóa viền mặc định */
            border-radius: 8px; /* Bo góc cho nút */
            cursor: pointer; /* Thay đổi con trỏ khi di chuột qua nút */
            transition: background-color 0.3s, transform 0.3s; /* Hiệu ứng chuyển đổi */
        }

        #authorize_button {
            background-color: #4CAF50; /* Màu nền xanh */
            color: white; /* Màu chữ trắng */
        }

        #authorize_button:hover {
            background-color: #45a049; /* Màu nền khi di chuột qua */
            transform: scale(1.05); /* Tăng kích thước một chút khi di chuột */
        }

        #signout_button {
            background-color: #f44336; /* Màu nền đỏ */
            color: white; /* Màu chữ trắng */
        }

        #signout_button:hover {
            background-color: #e53935; /* Màu nền khi di chuột qua */
            transform: scale(1.05); /* Tăng kích thước một chút khi di chuột */
        }

        /* Menu Styling */
        .menu {
            position: relative;
        }

        .hamburger {
            font-size: 12px;
            cursor: pointer;
        }

        .menu-content {
            display: none;
            position: fixed;
            color: #171717;
            background-color: #ffffff;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
            border: 1px solid #ae1e6a; /* Thêm viền cho menu */
            border-radius: 4px; /* Thêm góc bo nếu muốn */
        }

        .menu-content a {
            color: rgb(41, 38, 38);
            padding: 12px 16px;
            text-decoration: none;
            display: block; /* Thay đổi thành block để các đường viền hoạt động chính xác */
            border-bottom: 1px solid #e0e0e0; /* Đường phân biệt giữa các dòng */
        }

        .menu-content a:last-child {
            border-bottom: none; /* Xóa đường viền dưới cùng */
        }

        .menu-content a:hover {
            background-color: #ae1e6a;
            color: #ffffff;
        }


        .show {
            display: block;
        }
        
        /* Định dạng chung cho bảng */
        #excelTable10, #excelTable9 {
            width: 95vw;
            border-collapse: collapse;
            font-family: Arial, sans-serif;
            box-shadow: 0px 0px 12px rgba(0, 0, 0, 0.1);
            border-radius: 1px;
            overflow: hidden;
        }

        /* Định dạng cho tiêu đề cột */
        #excelTable10 th, #excelTable9 th {
            background-color: #ae1e6a;
            color: white;
            padding: 12px;
            text-align: center;
            font-size: 16px;
            font-weight: bold;
        }

        /* Định dạng cho các hàng dữ liệu */
        #excelTable10 td, #excelTable9 td {
            padding: 8px;
            border: 1px solid #ddd;
            text-align: center;
            border-radius: 3px;
        }

        /* Căn lề cho cột đầu tiên */
        #excelTable10 .left-align, #excelTable9 .left-align {
            text-align: left;
            padding-left: 15px;
        }

        /* Căn lề giữa cho các cột khác */
        #excelTable10 .center-align, #excelTable9 .center-align {
            text-align: center;
        }

        /* Màu nền cho các hàng chẵn và lẻ */
        #excelTable10 .even-row, #excelTable9 .even-row {
            background-color: #f9f9f9;
        }

        #excelTable10 .odd-row, #excelTable9 .odd-row {
            background-color: #ffffff;
        }

        /* Làm đậm các hàng có định dạng phần trăm */
        #excelTable10 .bold, #excelTable9 .bold {
            font-weight: bold;
        }

        /* Màu chữ đỏ cho các giá trị < 1 */
        #excelTable10 .red, #excelTable9 .red {
            color: red;
        }

        /* Hiệu ứng hover khi rê chuột vào hàng */
        #excelTable10 tr:hover, #excelTable9 tr:hover {
            background-color: #f1f1f1;
            cursor: pointer;
        }

        #Chartvtg1, #Chartvtg2 {
            display: inline-block;
            width: 100%;
            margin: auto;
            align-items: center;
        }


    </style>
    
</head>
<body>
    

    <div class="header">
        <div class="menu"></div>
            <div class="hamburger" onclick="toggleMenu()">&#9776;</div> 
            
            <div id="menuContent" class="menu-content">
                <a href="#" onclick="showDashboard()">Dashboard</a>

                <a href="#" onclick="showVTG()">VTG</a>
                <a href="#" onclick="showVTC()">VTC</a>
                <a href="#" onclick="showSTL()">STL</a>
                <a href="#" onclick="showVTL()">VTL</a>
                <a href="#" onclick="showMYN()">MYN</a>
                <a href="#" onclick="showVBD()">VBD</a>
                <a href="#" onclick="showMOV()">MOV</a>
                <a href="#" onclick="showVTZ()">VTZ</a>
                <a href="#" onclick="showNCM()">NCM</a>

                <a href="#" onclick="showCredit()">User agreement</a>

                    <!-- Add buttons to initiate auth sequence and sign out -->
                <button id="authorize_button" onclick="handleAuthClick()">Authorize</button>
                <button id="signout_button" onclick="handleSignoutClick()">Sign Out</button>
                
            </div>
        </div>

        
    </div>

    <!-- Loading spinner -->
    <div id="loadingSpinner" style="display: none;">
        <div class="spinner"></div>
        <div style="text-align: center;">
            <p>Click Authorize và chờ biểu đồ hiển thị</p>
            <button id="authorize_button" onclick="handleAuthClick()">Authorize</button>
        </div>
    </div>

    <div id="ChartContainer">
        <canvas id="Chart"></canvas>
    </div>

    <div id="vtgContent" style="display:none;">
        <div id="vtgLoadingSpinner" style="display: none;">
            <div class="spinner"></div>
            <p>Loading Data...</p>
        </div>
        <canvas id="Chartvtg1"></canvas>
        <canvas id="Chartvtg2"></canvas>
        <div id="Tablevtg1"></div>
    </div>
    
    <div id="vtcContent" style="display:none;">
        <div id="vtgLoadingSpinner" style="display: none;">
            <div class="spinner"></div>
            <p>Loading Data...</p>
        </div>
        <canvas id="Chartvtc1"></canvas>
        <canvas id="Chartvtc2"></canvas>
        <div id="Tablevtc1"></div>
    </div>

    <div id="stlContent" style="display:none;">
        <div id="vtgLoadingSpinner" style="display: none;">
            <div class="spinner"></div>
            <p>Loading Data...</p>
        </div>
        <canvas id="Chartstl1"></canvas>
        <canvas id="Chartstl2"></canvas>
        <div id="Tablestl1"></div>
    </div>

    <div id="vtlContent" style="display:none;">
        <div id="vtgLoadingSpinner" style="display: none;">
            <div class="spinner"></div>
            <p>Loading Data...</p>
        </div>
        <canvas id="Chartvtl1"></canvas>
        <canvas id="Chartvtl2"></canvas>
        <div id="Tablevtl1"></div>
    </div>

    <div id="mynContent" style="display:none;">
        <div id="vtgLoadingSpinner" style="display: none;">
            <div class="spinner"></div>
            <p>Loading Data...</p>
        </div>
        <canvas id="Chartmyn1"></canvas>
        <canvas id="Chartmyn2"></canvas>
        <div id="Tablemyn1"></div>
    </div>

    <div id="vbdContent" style="display:none;">
        <div id="vtgLoadingSpinner" style="display: none;">
            <div class="spinner"></div>
            <p>Loading Data...</p>
        </div>
        <canvas id="Chartvbd1"></canvas>
        <canvas id="Chartvbd2"></canvas>
        <div id="Tablevbd1"></div>
    </div>

    <div id="movContent" style="display:none;">
        <div id="vtgLoadingSpinner" style="display: none;">
            <div class="spinner"></div>
            <p>Loading Data...</p>
        </div>
        <canvas id="Chartmov1"></canvas>
        <canvas id="Chartmov2"></canvas>
        <div id="Tablemov1"></div>
    </div>

    <div id="vtzContent" style="display:none;">
        <div id="vtgLoadingSpinner" style="display: none;">
            <div class="spinner"></div>
            <p>Loading Data...</p>
        </div>
        <canvas id="Chartvtz1"></canvas>
        <canvas id="Chartvtz2"></canvas>
        <div id="Tablevtz1"></div>
    </div>

    <div id="ncmContent" style="display:none;">
        <div id="vtgLoadingSpinner" style="display: none;">
            <div class="spinner"></div>
            <p>Loading Data...</p>
        </div>
        <canvas id="Chartncm1"></canvas>
        <canvas id="Chartncm2"></canvas>
        <div id="Tablencm1"></div>
    </div>

    <div id="credit" style="display:none;">
        <pre id = "user_agreement"style="white-space: pre-wrap;font-family: Arial, sans-serif;"></pre>
        <p style="white-space: pre-wrap;font-family: Arial, sans-serif;">Tác giả: Nguyễn Văn Hào</p>
    </div>


    <script type="text/javascript">

        // Hàm để tải và hiển thị nội dung file user_agreement.txt
        fetch('user_agreement.txt')
            .then(response => response.text())
            .then(data => {
                document.getElementById('user_agreement').textContent = data;
            })
            .catch(error => console.error('Error loading user agreement:', error));

        let chartInstance; // Biến lưu giữ biểu đồ hiện tại
        let currentChartIndex = 0; // Bắt đầu từ biểu đồ đầu tiên
        let intervalId; // Biến lưu giữ quá trình lặp
        const chartFunctions = []; // Mảng lưu tất cả các hàm tạo biểu đồ
        

        window.onload = function() {
            showLoading();
            if (gapiInited && gisInited) {
                maybeEnableButtons(); // This will handle auto-login if token exists
            }
        };

        // TODO(developer): Set to client ID and API key from the Developer Console
        const CLIENT_ID = '199195142502-husfgej42uh6r285vq91n92vhs4urae3.apps.googleusercontent.com';
        const API_KEY = 'AIzaSyD98NNgcjUivgPxDwFecqxwUrQyq5zl-AI';

        // Discovery doc URL for APIs used by the quickstart
        const DISCOVERY_DOC = 'https://sheets.googleapis.com/$discovery/rest?version=v4';

        // Authorization scopes required by the API; multiple scopes can be
        // included, separated by spaces.
        const SCOPES = 'https://www.googleapis.com/auth/spreadsheets.readonly https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile';

        let tokenClient;
        let gapiInited = false;
        let gisInited = false;

        document.getElementById('authorize_button').style.display = 'static';
        document.getElementById('signout_button').style.display = 'none';

        /**
         * Callback after api.js is loaded.
         */
        function gapiLoaded() {
            gapi.load('client', initializeGapiClient);
        }

        /**
         * Callback after the API client is loaded. Loads the
         * discovery doc to initialize the API.
         */
        async function initializeGapiClient() {
            await gapi.client.init({
                apiKey: API_KEY,
                discoveryDocs: [DISCOVERY_DOC],
            });

            // Load thêm userinfo API
            await gapi.client.load('oauth2', 'v2');

            gapiInited = true;
            maybeEnableButtons();

            // Only call fetchExcelData() after initialization is completed.
            if (gapiInited && gisInited) {
                fetchExcelData();  // Ensure that gapi is initialized before fetching data.
            }
        }

        /**
         * Callback after Google Identity Services are loaded.
         */
        function gisLoaded() {
            tokenClient = google.accounts.oauth2.initTokenClient({
                client_id: CLIENT_ID,
                scope: SCOPES,
                callback: '', // defined later
            });
            gisInited = true;
            maybeEnableButtons();
        }

        /**
         * Enables user interaction after all libraries are loaded.
         */
        function maybeEnableButtons() {
            if (gapiInited && gisInited) {
                const storedToken = sessionStorage.getItem('access_token');
                if (storedToken) {
                    gapi.client.setToken({ access_token: storedToken });
                    // Fetch user info to ensure the token is still valid
                    gapi.client.oauth2.userinfo.get().then(response => {
                        document.getElementById('authorize_button').innerText = 'Refresh';
                        document.getElementById('signout_button').style.display = 'block';
                        fetchExcelData();  // Automatically fetch data if valid token exists
                    }).catch(err => {
                        console.log('Token invalid or expired, need to re-authorize.');
                        handleSignoutClick(); // Sign out if token is invalid/expired
                        handleAuthClick(); // Automatically call authorize after signout if needed
                    });
                } else {
                    // Automatically show authorization flow when the user is not signed in
                    handleAuthClick();
                }
            }
        }


        function checkAndRefreshToken() {
            // Xóa token cũ trước khi kiểm tra
            sessionStorage.removeItem('access_token');

            const token = gapi.client.getToken();
            if (token) {
                const expiresIn = token.expires_in || 3600;  // Default to 1 hour if not provided
                const expirationTime = token.timestamp + expiresIn * 1000;

                // If the token is close to expiring (within 1 minutes), refresh it
                if (Date.now() > expirationTime - 1 * 60 * 1000) {
                    tokenClient.requestAccessToken({ prompt: '' });
                }
            }
        }

        setInterval(checkAndRefreshToken, 1 * 60 * 1000);  // Check every 1 minutes

        /**
         *  Sign in the user upon button click.
         */
        function handleAuthClick() {
            tokenClient.callback = async (resp) => {
                if (resp.error !== undefined) {
                    throw (resp);
                }
                // Lưu token vào sessionStorage
                const token = gapi.client.getToken();
                sessionStorage.setItem('access_token', token.access_token);

                // Lấy thông tin người dùng
                const userInfo = await gapi.client.oauth2.userinfo.get().then(response => response.result);

                document.getElementById('signout_button').style.display = 'block';
                document.getElementById('authorize_button').innerText = 'Refresh';
                await fetchExcelData(); 

                // Ẩn các nút sau khi dữ liệu đã được tải
                document.getElementById('authorize_button').style.display = 'flex';
                document.getElementById('signout_button').style.display = 'none';
            };

            if (gapi.client.getToken() === null) {
                tokenClient.requestAccessToken({ prompt: 'consent' });
            } else {
                tokenClient.requestAccessToken({ prompt: '' });
            }
        }

        /**
         *  Sign out the user upon button click.
         */
        function handleSignoutClick() {
            alert('Bạn đã sign out')
            const token = gapi.client.getToken();
            if (token !== null) {
                google.accounts.oauth2.revoke(token.access_token);
                gapi.client.setToken('');
                document.getElementById('content').innerText = '';
                document.getElementById('authorize_button').innerText = 'Authorize';
                document.getElementById('signout_button').style.display = 'none';
                // Chỉ hiện nút authorize lại khi người dùng sign out
                document.getElementById('authorize_button').style.display = 'block';
            }
        }


        // Menu Toggle Function
        function toggleMenu() {
            const menu = document.getElementById('menuContent');
            //menuContent.style.display = menuContent.style.display === "block" ? "none" 
            menu.classList.toggle("show");
        }

        // Show Dashboard Function (default behavior)
        function showDashboard() {
            hideAllSections();
            document.getElementById('ChartContainer').style.display = "flex"; // Show chart container

            startLoop(); 

            toggleMenu();
        }

        

        function showVTG() {
            hideAllSections();
            document.getElementById('vtgContent').style.display = "flex"; 

            loadChartvtg1();

            toggleMenu();
        }

        function showVTC() {
            hideAllSections();
            document.getElementById('vtcContent').style.display = "flex"; 

            loadChartvtc1();

            toggleMenu();
        }

        function showSTL() {
            hideAllSections();
            document.getElementById('stlContent').style.display = "flex"; 

            loadChartstl1();

            toggleMenu();
        }

        function showVTL() {
            hideAllSections();
            document.getElementById('vtlContent').style.display = "flex"; 

            loadChartvtl1();

            toggleMenu();
        }

        function showMYN() {
            hideAllSections();
            document.getElementById('mynContent').style.display = "flex"; 

            loadChartmyn1();
            toggleMenu();
        }

        function showVBD() {
            hideAllSections();
            document.getElementById('vbdContent').style.display = "flex"; 

            loadChartvbd1();

            toggleMenu();
        }

        function showMOV() {
            hideAllSections();
            document.getElementById('movContent').style.display = "flex"; 

            loadChartmov1();

            toggleMenu();
        }

        function showVTZ() {
            hideAllSections();
            document.getElementById('vtzContent').style.display = "flex"; 

            loadChartvtz1();

            toggleMenu();
        }

        function showNCM() {
            hideAllSections();
            document.getElementById('ncmContent').style.display = "flex"; 

            loadChartncm1();

            toggleMenu();
        }

        // Show Credit Function
        function showCredit() {
            hideAllSections();
            document.getElementById('credit').style.display = "block"; // Show credit section

            toggleMenu();
        }

        // Hàm để ẩn tất cả các phần khác
        function hideAllSections() {
            document.getElementById('ChartContainer').style.display = "none";
            document.getElementById('vtgContent').style.display = "none";
            document.getElementById('vtcContent').style.display = "none";
            document.getElementById('stlContent').style.display = "none";
            document.getElementById('vtlContent').style.display = "none";
            document.getElementById('mynContent').style.display = "none";
            document.getElementById('vbdContent').style.display = "none";
            document.getElementById('movContent').style.display = "none";
            document.getElementById('vtzContent').style.display = "none";
            document.getElementById('ncmContent').style.display = "none";
            document.getElementById('credit').style.display = "none";
        }

        // Hàm hiển thị biểu tượng loading
        function showLoading() {
            document.getElementById('loadingSpinner').style.display = 'block';
        }

        // Hàm ẩn biểu tượng loading
        function hideLoading() {
            document.getElementById('loadingSpinner').style.display = 'none';
        }

        // Close the menu when clicking outside of it
        window.onclick = function(event) {
            const menu = document.getElementById('menuContent');
            if (!event.target.matches('.hamburger')) {
                if (menu.classList.contains('show')) {
                    menu.classList.remove('show');
                }
            }
        }

        async function loadChartData(sheetRanges) {
            // Show VTG loading spinner
            document.getElementById('vtgLoadingSpinner').style.display = 'block';

            let responses = {};

            try {
                // Fetch data from each specified range
                for (let [sheetName, range] of Object.entries(sheetRanges)) {
                    responses[sheetName] = await gapi.client.sheets.spreadsheets.values.get({
                        spreadsheetId: '1PR62ufQsg8k2ETFkZx1c8O7cwWU73_8FfWnZ1XH57fw',
                        range: range,
                    });
                }
            } catch (err) {
                document.getElementById('content').innerText = err.message;
                hideLoading();
                return null;
            }

            document.getElementById('vtgLoadingSpinner').style.display = 'none';

            // Process data for each sheet
            const processedData = {};
            for (let sheetName in responses) {
                processedData[sheetName] = processSheetData(responses[sheetName].result, sheetName);
            }

            return processedData;
        }

        function processSheetData(range, sheetName) {
            if (!range || !range.values || range.values.length == 0) {
                document.getElementById('content').innerText = `No values found in ${sheetName}.`;
                return [];
            }
            // Get headers from the first row
            const headers = range.values[0];
            const jsonData = [];
            
            // Process each row and convert to JSON
            range.values.slice(1).forEach(row => {  // Use slice(1) to skip the header row
                const rowData = {};
                headers.forEach((header, index) => {
                    let cellValue = row[index] !== undefined ? row[index] : null;
                    // Try to convert to a number if possible
                    if (!isNaN(cellValue) && cellValue !== null && cellValue !== '') {
                        cellValue = parseFloat(cellValue); 
                    }
                    
                    rowData[header] = cellValue;
                });

                jsonData.push(rowData);
            });
            
            return jsonData;
        }

        async function fetchExcelData() {
            const sheetRanges = {
                'Sheet1': 'Sheet1!A:K',
                'Sheet3': 'Sheet3!A:I',
                'Sheet9': 'Sheet9!A:J'
            };

            const data = await loadChartData(sheetRanges);
            if (!data) return;  // If data loading failed, exit function

            // Clear existing chart functions before pushing new ones
            chartFunctions.length = 0; // Empty the array before re-populating

            chartFunctions.push(() => create_HTKH_DTDV(data['Sheet1']));
            chartFunctions.push(() => create_HTKH_TBPSGDTT(data['Sheet1']));
            chartFunctions.push(() => create_YoY_DTDV(data['Sheet1']));
            chartFunctions.push(() => create_YoY_TBPSGDLK(data['Sheet1']));
            chartFunctions.push(() => create_MoM_DTDV(data['Sheet1']));
            chartFunctions.push(() => create_MoM_TBPSGDLK(data['Sheet1']));

            chartFunctions.push(() => create_DTDV_daily_trend(data['Sheet3']));
            chartFunctions.push(() => create_TBPSGDLK_daily_trend(data['Sheet3']));
            chartFunctions.push(() => create_DTDV_daily_trend_VTC(data['Sheet3']));
            chartFunctions.push(() => create_TBPSGDLK_daily_trend_VTC(data['Sheet3']));
            chartFunctions.push(() => create_DTDV_daily_trend_STL(data['Sheet3']));
            chartFunctions.push(() => create_TBPSGDLK_daily_trend_STL(data['Sheet3']));
            chartFunctions.push(() => create_DTDV_daily_trend_VTL(data['Sheet3']));
            chartFunctions.push(() => create_TBPSGDLK_daily_trend_VTL(data['Sheet3']));
            chartFunctions.push(() => create_DTDV_daily_trend_MYN(data['Sheet3']));
            chartFunctions.push(() => create_TBPSGDLK_daily_trend_MYN(data['Sheet3']));
            chartFunctions.push(() => create_DTDV_daily_trend_VBD(data['Sheet3']));
            chartFunctions.push(() => create_TBPSGDLK_daily_trend_VBD(data['Sheet3']));
            chartFunctions.push(() => create_DTDV_daily_trend_MOV(data['Sheet3']));
            chartFunctions.push(() => create_TBPSGDLK_daily_trend_MOV(data['Sheet3']));
            chartFunctions.push(() => create_DTDV_daily_trend_VTZ(data['Sheet3']));
            chartFunctions.push(() => create_TBPSGDLK_daily_trend_VTZ(data['Sheet3']));
            chartFunctions.push(() => create_DTDV_daily_trend_NCM(data['Sheet3']));
            chartFunctions.push(() => create_TBPSGDLK_daily_trend_NCM(data['Sheet3'])); 

            chartFunctions.push(() => createTable9(data['Sheet9']));
            
            hideLoading(); // Hide the loading icon after data is loaded
            startLoop();   // Show the first chart and start looping through
        }


        function startLoop() {
            // Hiển thị biểu đồ đầu tiên
            chartFunctions[currentChartIndex]();

            // Tạo vòng lặp chuyển đổi giữa tất cả các biểu đồ và bảng
            intervalId = setInterval(() => {
                destroyChartorTable(); // Xóa biểu đồ hiện tại hoặc bảng

                // Tăng chỉ số biểu đồ để chuyển sang biểu đồ tiếp theo
                currentChartIndex = (currentChartIndex + 1) % chartFunctions.length;

                // Gọi hàm tạo biểu đồ hoặc bảng tiếp theo từ mảng
                chartFunctions[currentChartIndex]();
            }, 3000); // Chuyển đổi mỗi 10 giây
        }

        function destroyChartorTable() {
            if (chartInstance) {
                chartInstance.destroy(); // Xóa biểu đồ hiện tại
            }

            // Xóa nội dung bảng nếu tồn tại
            const table = document.getElementById('excelTable9');
            if (table) {
                table.remove(); // Xóa bảng trước khi tạo biểu đồ mới
            }

            // Đảm bảo canvas tồn tại trước khi tạo biểu đồ
            const chartContainer = document.getElementById('ChartContainer');
            if (!document.getElementById('Chart')) {
                const canvas = document.createElement('canvas');
                canvas.id = 'Chart';
                chartContainer.appendChild(canvas); // Thêm canvas vào container
            }
        }

        function formatNumber(num) {
            // Kiểm tra xem num có phải là một số không
            if (typeof num !== 'number') return num; // Nếu không phải số thì trả về giá trị gốc
            return num.toLocaleString('en-US', { minimumFractionDigits: 1, maximumFractionDigits: 1 });
        }
        function formatPercentage(num) {
            // Kiểm tra xem num có phải là một số không
            if (typeof num !== 'number') return num; // Nếu không phải số thì trả về giá trị gốc
            return (num * 100).toLocaleString('en-US', { minimumFractionDigits: 1, maximumFractionDigits: 1 }) + '%'; // Định dạng phần trăm
        }

        
        //Tạo biểu đồ đường        
        function createLinechart(ctx, labels, TH, KH, last_month, last_year, date, name,market) {
            return new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'TH',
                            data: TH,
                            backgroundColor: 'rgba(255, 99, 132, 1)', // Làm nổi bật TH với màu rõ hơn
                            borderColor: 'rgba(255, 99, 132, 1)', // Màu đậm hơn cho TH
                            fill: false,
                            tension: 0.1,
                            borderWidth: 4 // Tăng độ dày đường TH
                        },
                        {
                            label: 'KH',
                            data: KH,
                            backgroundColor: 'rgba(54, 162, 235, 0.3)', // Làm mờ KH với màu nhạt hơn
                            borderColor: 'rgba(54, 162, 235, 0.3)', // Màu nhạt hơn cho KH
                            fill: false,
                            tension: 0.1,
                            borderDash: [5, 5],
                            borderWidth: 2 // Giảm độ dày của đường
                        },
                        {
                            label: 'Tháng trước',
                            data: last_month,
                            backgroundColor: 'rgba(255, 206, 86, 0.3)', // Làm mờ đường Tháng trước
                            borderColor: 'rgba(255, 206, 86, 0.3)',
                            fill: false,
                            tension: 0.1,
                            borderDash: [10, 5],
                            borderWidth: 2 // Giảm độ dày của đường
                        },
                        {
                            label: 'Năm trước',
                            data: last_year,
                            backgroundColor: 'rgba(153, 102, 255, 0.3)', // Làm mờ đường Năm trước
                            borderColor: 'rgba(153, 102, 255, 0.3)',
                            fill: false,
                            tension: 0.1,
                            borderDash: [15, 5],
                            borderWidth: 2 // Giảm độ dày của đường
                        }
                    ]
                },
                options: {
                    animation: {
                        y: {
                            easing: 'easeInOutElastic',
                            from: (ctx) => {
                                if (ctx.type === 'data') {
                                    if (ctx.mode === 'default' && !ctx.dropped) {
                                        ctx.dropped = true;
                                        return 0;
                                    }
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            stacked: false
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: `Xu hướng ${name} đến ngày ${date} của ${market}`,
                            font: {
                                size: 18
                            },
                            padding: {
                                top: 10,
                                bottom: 30
                            }
                        },
                        datalabels: {
                            display: true,
                            color: 'black',
                            font: {
                                weight: 'bold'
                            },
                            anchor: 'end',
                            align: 'start',
                            formatter: function(value) {
                                return value; // Hiển thị giá trị
                            }
                        }
                    }
                }
            });
        }


        function readinputLinechart(data, id) {
            const filteredData = data.filter(row => row['ID'] === id);
            const date = data[0]['Month'];
            const labels = [];
            const TH = [];
            const KH = [];
            const last_month = [];
            const last_year = [];

            // Lặp qua các hàng dữ liệu
            filteredData.forEach(row => {
                // Nếu ít nhất một giá trị khác 0 thì thêm nhãn ngày
                if (row['TH'] !== 0 || row['KH'] !== 0 || row['TH m-1'] !== 0 || row['TH y-1'] !== 0) {
                    labels.push(row['Date']);  // Thêm ngày vào nhãn
                }

                // Thêm dữ liệu từng mảng nếu giá trị tương ứng khác 0
                TH.push(row['TH'] !== 0 ? row['TH'] : null);         // Thêm giá trị TH nếu khác 0, nếu không thêm null
                KH.push(row['KH'] !== 0 ? row['KH'] : null);         // Tương tự cho KH
                last_month.push(row['TH m-1'] !== 0 ? row['TH m-1'] : null); // Tương tự cho Tháng trước
                last_year.push(row['TH y-1'] !== 0 ? row['TH y-1'] : null);  // Tương tự cho Năm trước
            });

            return {
                labels: labels,
                TH: TH,
                KH: KH,
                last_month: last_month,
                last_year: last_year,
                date: date
            };
        }
        
//Tạo biểu đồ cột
        function createBarchart(ctx, labels, values, date, name, compare,alert) {
            // Create an array of background colors based on conditions
            const backgroundColors = values.map((value, index) => {
                if (value < alert) {
                    return 'rgb(231, 0, 58)'; // Red for values less than 1
                } else {
                    return 'rgba(75, 192, 192, 0.6)'; // Default color
                }
            });

            // Kết hợp các nhãn, giá trị và màu sắc thành đối tượng
            const dataWithColors = labels.map((label, index) => ({
                label: label,
                value: values[index],
                color: backgroundColors[index]
            }));

            // Tách phần tử "VTG" và phần còn lại của dữ liệu
            const vtgData = dataWithColors.filter(item => item.label === 'VTG');
            const otherData = dataWithColors.filter(item => item.label !== 'VTG');

            // Sắp xếp phần dữ liệu còn lại dựa trên giá trị (từ nhỏ đến lớn)
            const sortedOtherData = otherData.sort((a, b) => a.value - b.value);

            // Ghép "VTG" vào đầu tiên
            const sortedData = [ ...vtgData,...sortedOtherData];

            // Lấy lại các nhãn, giá trị và màu sắc sau khi sắp xếp
            const sortedLabels = sortedData.map(item => item.label);
            const sortedValues = sortedData.map(item => item.value);
            const sortedColors = sortedData.map(item => item.color);

            return new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedLabels,
                    datasets: [{
                        label: compare,
                        data: sortedValues,
                        backgroundColor: sortedColors, // Use the sorted colors
                    }]
                },
                options: {
                    animation: {
                        duration: 1000, 
                        easing: 'easeOutBounce'
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            stacked: true,
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: `${name} ${compare} đến ngày ${date}`,
                            font: {
                                size: 24
                            },
                            padding: {
                                top: 10,
                                bottom: 30
                            }
                        },
                        tooltip: {
                            enabled: false // Disable tooltip if not needed
                        },
                        datalabels: {
                            display: true,
                            color: function(context) {
                                // Change label color based on bar color
                                return context.dataset.backgroundColor[context.dataIndex] === 'rgb(231, 0, 58)' 
                                    ? 'black' // White text for red bars
                                    : 'black'; // Black text for other bars
                            },
                            font: {
                                weight: 'bold',
                                size: 20
                            },
                            anchor: 'end',
                            align: 'start',
                            offset: -50,
                            formatter: function(value) {
                                return formatPercentage(value); // Display value as percentage
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }


        function readinputBarchart(data, ref,compare) {
            const filteredData = data.filter(row => row['Ref'] === ref); 
            const labels = filteredData.map(row => row['Thị trường']); 
            const values = filteredData.map(row => row[compare]);
            const date = data[0]['Date']; 
            return {
                labels: labels,
                values: values,
                date: date,
            };
        }


        // Helper function to generate a chart with specified settings
        function generateBarChart(data, ref, compare, name, compareText, alert) {
            const { labels, values, date } = readinputBarchart(data, ref, compare);
            const ctx = document.getElementById('Chart').getContext('2d');
            return createBarchart(ctx, labels, values, date, name, compareText, alert);
        }

        // Functions to create specific charts using generateChart with appropriate parameters
        function create_HTKH_DTDV(data) {
            chartInstance = generateBarChart(data, 163, 'HTKH', 'DTDV', 'Tiến độ ngày', 1);
        }

        function create_HTKH_TBPSGDTT(data) {
            chartInstance = generateBarChart(data, 313, 'HTKH', 'TB PSGD tăng thêm', 'Tiến độ ngày', 1);
        }

        function create_YoY_DTDV(data) {
            chartInstance = generateBarChart(data, 163, 'YoY', 'DTDV', 'So với năm trước', 0);
        }

        function create_YoY_TBPSGDLK(data) {
            chartInstance = generateBarChart(data, 312, 'YoY', 'TB PSGD LK', 'So với năm trước', 0);
        }

        function create_MoM_DTDV(data) {
            chartInstance = generateBarChart(data, 163, 'MoM', 'DTDV', 'So với tháng trước', 0);
        }

        function create_MoM_TBPSGDLK(data) {
            chartInstance = generateBarChart(data, 312, 'MoM', 'TB PSGD LK', 'So với tháng trước', 0);
        }

        function generateLineChart(data, element, ref, name, market) {
            const { labels, TH, KH, last_month, last_year, date } = readinputLinechart(data, ref);
            const ctx = document.getElementById(element).getContext('2d');
            return createLinechart(ctx, labels, TH, KH, last_month, last_year, date, name, market);
        }


        function create_DTDV_daily_trend(data) {
            const name = 'DTDV';
            const market = 'VTG';
            const ref = 'VTG163';
            const element = 'Chart';
            chartInstance = generateLineChart(data, element, ref, name, market);
        }

        function create_TBPSGDLK_daily_trend(data) {
            const name = 'TB PSGD lũy kế';
            const market = 'VTG';
            const ref = 'VTG312';
            const element = 'Chart';
            chartInstance = generateLineChart(data, element, ref, name, market);
        }

        function create_DTDV_daily_trend_VTC(data) {
            const name = 'DTDV';
            const market = 'VTC';
            const ref = 'VTC163';
            const element = 'Chart';
            chartInstance = generateLineChart(data, element, ref, name, market);
        }

        function create_TBPSGDLK_daily_trend_VTC(data) {
            const name = 'TB PSGD lũy kế';
            const market = 'VTC';
            const ref = 'VTC312';
            const element = 'Chart';
            chartInstance = generateLineChart(data, element, ref, name, market);
        }

        function create_DTDV_daily_trend_STL(data) {
            const name = 'DTDV';
            const market = 'STL';
            const ref = 'VTC312';
            const element = 'Chart';
            chartInstance = generateLineChart(data, element, ref, name, market);
            
        }

        function create_TBPSGDLK_daily_trend_STL(data) {
            const name = 'TB PSGD lũy kế';
            const market = 'STL';
            const ref = 'STL312';
            const element = 'Chart';
            chartInstance = generateLineChart(data, element, ref, name, market);
        }

        function create_DTDV_daily_trend_VTL(data) {
            const name = 'DTDV';
            const market = 'VTL';
            const ref = 'VTL163';
            const element = 'Chart';
            chartInstance = generateLineChart(data, element, ref, name, market);
        }

        function create_TBPSGDLK_daily_trend_VTL(data) {
            const name = 'TB PSGD lũy kế';
            const market = 'VTL';
            const ref = 'VTL312';
            const element = 'Chart';
            chartInstance = generateLineChart(data, element, ref, name, market);
        }

        function create_DTDV_daily_trend_MYN(data) {
            const name = 'DTDV';
            const market = 'MYN';
            const ref = 'MYN163';
            const element = 'Chart';
            chartInstance = generateLineChart(data, element, ref, name, market);
        }

        function create_TBPSGDLK_daily_trend_MYN(data) {
            const name = 'TB PSGD lũy kế';
            const market = 'MYN';
            const ref = 'MYN312';
            const element = 'Chart';
            chartInstance = generateLineChart(data, element, ref, name, market);
        }
        
        function create_DTDV_daily_trend_VBD(data) {
            const name = 'DTDV';
            const market = 'VBD';
            const ref = 'VBD163';
            const element = 'Chart';
            chartInstance = generateLineChart(data, element, ref, name, market);
        }

        function create_TBPSGDLK_daily_trend_VBD(data) {
            const name = 'TB PSGD lũy kế';
            const market = 'VBD';
            const ref = 'VBD312';
            const element = 'Chart';
            chartInstance = generateLineChart(data, element, ref, name, market);
        }

        function create_DTDV_daily_trend_MOV(data) {
            const name = 'DTDV';
            const market = 'MOV';
            const ref = 'MOV163';
            const element = 'Chart';
            chartInstance = generateLineChart(data, element, ref, name, market);
        }

        function create_TBPSGDLK_daily_trend_MOV(data) {
            const name = 'TB PSGD lũy kế';
            const market = 'MOV';
            const ref = 'MOV312';
            const element = 'Chart';
            chartInstance = generateLineChart(data, element, ref, name, market);
        }
        function create_DTDV_daily_trend_VTZ(data) {
            const name = 'DTDV';
            const market = 'VTZ';
            const ref = 'VTZ163';
            const element = 'Chart';
            chartInstance = generateLineChart(data, element, ref, name, market);
        }

        function create_TBPSGDLK_daily_trend_VTZ(data) {
            const name = 'TB PSGD lũy kế';
            const market = 'VTZ';
            const ref = 'VTZ312';
            const element = 'Chart';
            chartInstance = generateLineChart(data, element, ref, name, market);
        }

        function create_DTDV_daily_trend_NCM(data) {
            const name = 'DTDV';
            const market = 'NCM';
            const ref = 'NAT163';
            const element = 'Chart';
            chartInstance = generateLineChart(data, element, ref, name, market);
        }

        function create_TBPSGDLK_daily_trend_NCM(data) {
            const name = 'TB PSGD lũy kế';
            const market = 'NCM';
            const ref = 'NAT312';
            const element = 'Chart';
            chartInstance = generateLineChart(data, element, ref, name, market);
        }
        
        async function loadChartvtg1() {
            const sheetRanges = {
                'Sheet3': 'Sheet3!A:I',
                'Sheet9': 'Sheet9!A:J'
            };

            const data = await loadChartData(sheetRanges);
            if (!data) return;  

            // Use the processed data to create charts and tables
            createChartvtg1(data['Sheet3']);
            createChartvtg2(data['Sheet3']);
            createTablevtg1(data['Sheet9']);
        }

        async function loadChartvtc1() {
            const sheetRanges = {
                'Sheet3': 'Sheet3!A:I',
                'Sheet9': 'Sheet9!A:J'
            };

            const data = await loadChartData(sheetRanges);
            if (!data) return;  

            // Use the processed data to create charts and tables
            createChartvtc1(data['Sheet3']);
            createChartvtc2(data['Sheet3']);
            createTablevtc1(data['Sheet9']);
        }

        async function loadChartstl1() {
            const sheetRanges = {
                'Sheet3': 'Sheet3!A:I',
                'Sheet9': 'Sheet9!A:J'
            };

            const data = await loadChartData(sheetRanges);
            if (!data) return;  

            // Use the processed data to create charts and tables
            createChartstl1(data['Sheet3']);
            createChartstl2(data['Sheet3']);
            createTablestl1(data['Sheet9']);
        }

        async function loadChartvtl1() {
            const sheetRanges = {
                'Sheet3': 'Sheet3!A:I',
                'Sheet9': 'Sheet9!A:J'
            };

            const data = await loadChartData(sheetRanges);
            if (!data) return;  

            // Use the processed data to create charts and tables
            createChartvtl1(data['Sheet3']);
            createChartvtl2(data['Sheet3']);
            createTablevtl1(data['Sheet9']);
        }

        async function loadChartmyn1() {
            const sheetRanges = {
                'Sheet3': 'Sheet3!A:I',
                'Sheet9': 'Sheet9!A:J'
            };

            const data = await loadChartData(sheetRanges);
            if (!data) return;  

            // Use the processed data to create charts and tables
            createChartmyn1(data['Sheet3']);
            createChartmyn2(data['Sheet3']);
            createTablemyn1(data['Sheet9']);
        }

        async function loadChartvbd1() {
            const sheetRanges = {
                'Sheet3': 'Sheet3!A:I',
                'Sheet9': 'Sheet9!A:J'
            };

            const data = await loadChartData(sheetRanges);
            if (!data) return;  

            // Use the processed data to create charts and tables
            createChartvbd1(data['Sheet3']);
            createChartvbd2(data['Sheet3']);
            createTablevbd1(data['Sheet9']);
        }

        async function loadChartmov1() {
            const sheetRanges = {
                'Sheet3': 'Sheet3!A:I',
                'Sheet9': 'Sheet9!A:J'
            };

            const data = await loadChartData(sheetRanges);
            if (!data) return;  

            // Use the processed data to create charts and tables
            createChartmov1(data['Sheet3']);
            createChartmov2(data['Sheet3']);
            createTablemov1(data['Sheet9']);
        }

        async function loadChartvtz1() {
            const sheetRanges = {
                'Sheet3': 'Sheet3!A:I',
                'Sheet9': 'Sheet9!A:J'
            };

            const data = await loadChartData(sheetRanges);
            if (!data) return;  

            // Use the processed data to create charts and tables
            createChartvtz1(data['Sheet3']);
            createChartvtz2(data['Sheet3']);
            createTablevtz1(data['Sheet9']);
        }

        async function loadChartncm1() {
            const sheetRanges = {
                'Sheet3': 'Sheet3!A:I',
                'Sheet9': 'Sheet9!A:J'
            };

            const data = await loadChartData(sheetRanges);
            if (!data) return;  

            // Use the processed data to create charts and tables
            createChartncm1(data['Sheet3']);
            createChartncm2(data['Sheet3']);
            createTablencm1(data['Sheet9']);
        }

        // Biểu đồ 1vtg
        function createChartvtg1(data) {
            const name = 'DTDV';
            const market = 'VTG';
            const ref = 'VTG163';
            const element = 'Chartvtg1';
            const lineChart = generateLineChart(data, element, ref, name, market);
        }

        function createChartvtg2(data) {
            const name = 'TB PSGD';
            const market = 'VTG';
            const ref = 'VTG312';
            const element = 'Chartvtg2';
            const lineChart = generateLineChart(data, element, ref, name, market);
        }


        // Biểu đồ 1vtc
        function createChartvtc1(data) {
            const name = 'DTDV';
            const market = 'VTC';
            const ref = 'VTC163';
            const element = 'Chartvtc1';
            const lineChart = generateLineChart(data, element, ref, name, market);
        }

        function createChartvtc2(data) {
            const name = 'TB PSGD';
            const market = 'VTC';
            const ref = 'VTC312';
            const element = 'Chartvtc2';
            const lineChart = generateLineChart(data, element, ref, name, market);
        }

        // Biểu đồ 1stl
        function createChartstl1(data) {
            const name = 'DTDV';
            const market = 'STL';
            const ref = 'STL163';
            const element = 'Chartstl1';
            const lineChart = generateLineChart(data, element, ref, name, market);
        }

        function createChartstl2(data) {
            const name = 'TB PSGD';
            const market = 'STL';
            const ref = 'STL312';
            const element = 'Chartstl2';
            const lineChart = generateLineChart(data, element, ref, name, market);
        }

        function createChartvtl1(data) {
            const name = 'DTDV';
            const market = 'VTL';
            const ref = 'VTL163';
            const element = 'Chartvtl1';
            const lineChart = generateLineChart(data, element, ref, name, market);
        }

        function createChartvtl2(data) {
            const name = 'TB PSGD';
            const market = 'VTL';
            const ref = 'VTL312';
            const element = 'Chartvtl2';
            const lineChart = generateLineChart(data, element, ref, name, market);
        }

        function createChartmyn1(data) {
            const name = 'DTDV';
            const market = 'MYN';
            const ref = 'MYN163';
            const element = 'Chartmyn1';
            const lineChart = generateLineChart(data, element, ref, name, market);
        }

        function createChartmyn2(data) {
            const name = 'TB PSGD';
            const market = 'MYN';
            const ref = 'MYN312';
            const element = 'Chartmyn2';
            const lineChart = generateLineChart(data, element, ref, name, market);
        }
        
        function createChartvbd1(data) {
            const name = 'DTDV';
            const market = 'VBD';
            const ref = 'VBD163';
            const element = 'Chartvbd1';
            const lineChart = generateLineChart(data, element, ref, name, market);
        }

        function createChartvbd2(data) {
            const name = 'TB PSGD';
            const market = 'VBD';
            const ref = 'VBD312';
            const element = 'Chartvbd2';
            const lineChart = generateLineChart(data, element, ref, name, market);
        }

        function createChartmov1(data) {
            const name = 'DTDV';
            const market = 'MOV';
            const ref = 'MOV163';
            const element = 'Chartmov1';
            const lineChart = generateLineChart(data, element, ref, name, market);
        }

        function createChartmov2(data) {
            const name = 'TB PSGD';
            const market = 'MOV';
            const ref = 'MOV312';
            const element = 'Chartmov2';
            const lineChart = generateLineChart(data, element, ref, name, market);
        }

        function createChartvtz1(data) {
            const name = 'DTDV';
            const market = 'VTZ';
            const ref = 'VTZ163';
            const element = 'Chartvtz1';
            const lineChart = generateLineChart(data, element, ref, name, market);
        }

        function createChartvtz2(data) {
            const name = 'TB PSGD';
            const market = 'VTZ';
            const ref = 'VTZ312';
            const element = 'Chartvtz2';
            const lineChart = generateLineChart(data, element, ref, name, market);
        }

        function createChartncm1(data) {
            const name = 'DTDV';
            const market = 'NAT';
            const ref = 'NAT163';
            const element = 'Chartncm1';
            const lineChart = generateLineChart(data, element, ref, name, market);
        }

        function createChartncm2(data) {
            const name = 'TB PSGD';
            const market = 'NAT';
            const ref = 'NAT312';
            const element = 'Chartncm2';
            const lineChart = generateLineChart(data, element, ref, name, market);
        }


        // Utility function to render a table in a given container with specified data and table ID
        function renderTable(data, containerId, tableId) {
            const container = document.getElementById(containerId);
            container.innerHTML = "";  // Clear previous content
            const table = createTable(data, tableId);
            container.appendChild(table);  // Append the created table
        }

        // Unified table creation function
        function createTable(data, tableId) {
            const table = document.createElement('table');
            table.id = tableId;

            // Table caption
            const caption = document.createElement('caption');
            caption.textContent = "Bảng tổng hợp"; // Customize as needed
            table.appendChild(caption);

            // Create header row from data keys
            const headerRow = document.createElement('tr');
            const headers = Object.keys(data[0]);
            headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                headerRow.appendChild(th);
            });
            table.appendChild(headerRow);

            // Create data rows
            data.forEach((row, rowIndex) => {
                const tr = document.createElement('tr');
                const values = Object.values(row);

                values.forEach((value, index) => {
                    const td = document.createElement('td');
                    td.className = (index === 0) ? 'left-align' : 'center-align';

                    // Format specific rows (e.g., rowIndex 0, 5, 10, etc.) as percentages and bold
                    if ([0, 5, 10, 15, 20].includes(rowIndex)) {
                        td.textContent = formatPercentage(value);
                        td.classList.add('bold');
                        if (value < 1) td.classList.add('red'); // Add red color if value < 1
                    } else {
                        td.textContent = formatNumber(value);
                    }

                    tr.appendChild(td);
                });

                // Apply alternating row colors
                tr.classList.add(rowIndex % 2 === 0 ? 'even-row' : 'odd-row');
                table.appendChild(tr);
            });

            return table;
        }

        // Specific functions to create tables for different containers, using renderTable
        function createTable9(data) {
            const container = document.getElementById('ChartContainer');
            container.innerHTML = "";  
            const table = createTable(data, 'excelTable9');
            container.appendChild(table);  
        }

        function createTablevtg1(data) {
            renderTable(data, 'Tablevtg1', 'excelTable10');
        }

        function createTablevtc1(data) {
            renderTable(data, 'Tablevtc1', 'excelTable10');
        }

        function createTablestl1(data) {
            renderTable(data, 'Tablestl1', 'excelTable10');
        }

        function createTablevtl1(data) {
            renderTable(data, 'Tablevtl1', 'excelTable10');
        }
        
        function createTablemyn1(data) {
            renderTable(data, 'Tablemyn1', 'excelTable10');
        }
        
        function createTablevbd1(data) {
            renderTable(data, 'Tablevbd1', 'excelTable10');
        }
        
        function createTablemov1(data) {
            renderTable(data, 'Tablemov1', 'excelTable10');
        }

        function createTablevtz1(data) {
            renderTable(data, 'Tablevtz1', 'excelTable10');
        }

        function createTablencm1(data) {
            renderTable(data, 'Tablencm1', 'excelTable10');
        }


    </script>
</body>
</html>

